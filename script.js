(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e,r){for(var n=0;n<r.length;n++){var o=r[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,r){if("object"!==t(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==t(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===t(i)?i:String(i)),o)}var i}var r=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.managerHandler=e,this.world=r}var r,n;return r=t,(n=[{key:"tick",value:function(t){this.world.tick(t)}},{key:"render",value:function(t){this.world.render(t)}},{key:"getManagerHandler",value:function(){return this.managerHandler}},{key:"getWorld",value:function(){return this.world}},{key:"setWorld",value:function(t){this.world=t}}])&&e(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===n(i)?i:String(i)),o)}var i}var i=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.managerHandler=e,this.initializeEvents()}var e,r;return e=t,(r=[{key:"getMouseXFromEvent",value:function(t){return t.offsetX}},{key:"getMouseYFromEvent",value:function(t){return t.offsetY}},{key:"initializeEvents",value:function(){var t=this,e=this.managerHandler.getGraphicsManager().getCanvas();e.onclick=function(e){var r=t.getMouseXFromEvent(e),n=t.getMouseYFromEvent(e);t.managerHandler.event("click",{x:r,y:n})},e.onmousemove=function(e){var r=t.getMouseXFromEvent(e),n=t.getMouseYFromEvent(e);t.managerHandler.event("move",{x:r,y:n})}}}])&&o(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),a=window.location.href,u={BIG_FONT_SIZE:32,FONT_SIZE:24,MASSIVE_FONT_SIZE:64,COLORS:{GREY:"#888888",BLACK:"#333333",PURPLE:"#7B538F",LIGHT_PURPLE:"#BD7FDB",DARK_PURPLE:"#4F355C",CREAM:"#FCEDC3",RED:"#FF2F4C",LIGHT_RED:"#FF7A8C",DARK_RED:"#803D46"},FPS:60,GAME_WIDTH:1024,GAME_HEIGHT:768,SPATIAL_GRID_SIZE:64,ACTIONS:{ATTACK:"Attack!",REROLL:"Reroll"},TYPES:{CHAMP:"champ",ENEMY:"enemy",BLACK_ITEM:"black-item",WHITE_ITEM:"white-item",STATIC_BUTTON:"static-button",ACTION_BUTTON:"action-button"},WHITE_BANNERS:{CHAMPION:"champion",FIGHTER:"fighter",PALADIN:"paladin",THIEF:"thief",WIZARD:"wizard",SCROLL:"scroll"},BLACK_BANNERS:{DRAGON:"dragon",GOBLIN:"goblin",SKELETON:"skeleton",SLIME:"slime",POTION:"potion",TREASURE_CHEST:"treasure-chest"},BASE_PATH:a=a.replace(/index.html/,""),ASSETS_PATH:"".concat(a,"src/resources"),MUSIC_PATH:"".concat(a,"src/music")};function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==c(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===c(o)?o:String(o)),n)}var o}var l=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.customizeContext(),this.initializeCanvas(),this.initializeGraphics()}var e,r;return e=t,r=[{key:"customizeContext",value:function(){var t=this;CanvasRenderingContext2D.prototype.drawSprite=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;if(!e)throw new Error("asset is undefined in GraphicsManager.drawSprite!!");o||(o=e.width),i||(i=e.height),t.graphics.drawImage(e.sheet,e.x,e.y,e.width,e.height,r,n,o,i)},CanvasRenderingContext2D.prototype.drawText=function(e,r,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:u.COLORS.DARK_PURPLE,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:u.FONT_SIZE;t.graphics.font="".concat(a,"px Roboto Slab"),i&&(t.graphics.fillStyle="black",t.graphics.fillText(e,r-1,n+1)),t.graphics.fillStyle=o,t.graphics.fillText(e,r,n)}}},{key:"initializeCanvas",value:function(){this.canvas=document.querySelector("#canvas"),this.canvas.setAttribute("width",u.GAME_WIDTH),this.canvas.setAttribute("height",u.GAME_HEIGHT)}},{key:"initializeGraphics",value:function(){this.graphics=this.canvas.getContext("2d"),this.graphics.imageSmoothingEnabled=!1,this.graphics.webkitImageSmoothingEnabled=!1}},{key:"getCanvas",value:function(){return this.canvas}},{key:"getGraphics",value:function(){return this.graphics}}],r&&s(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function f(t){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f(t)}function y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==f(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==f(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===f(o)?o:String(o)),n)}var o}var h=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"loadImage",value:function(t){var e=new Image;return e.src=t,e.onerror=function(){throw new Error("Image not found at path ".concat(t))},e}}],null&&y(e.prototype,null),r&&y(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function b(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==p(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==p(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===p(o)?o:String(o)),n)}var o}var d=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sheet=e}var e,r;return e=t,(r=[{key:"crop",value:function(t,e,r,n){return{sheet:this.sheet,x:t,y:e,width:r,height:n}}}])&&b(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==v(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==v(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===v(o)?o:String(o)),n)}var o}var S={},g=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),S[e]=this,this.name=e,this.path=u.ASSETS_PATH,n&&(this.path+="/".concat(n)),this.path+="/".concat(r);var o=h.loadImage(this.path);this.sheet=new d(o),this.animations={}}var e,r,n;return e=t,n=[{key:"getAssets",value:function(t){if(!S[t])throw new Error("No asset exists of name: ".concat(t));return S[t]}}],(r=[{key:"addAnimation",value:function(t,e){if(this.animations[t])throw new Error("There is already an Asset named ".concat(t));this.animations[t]=e}}])&&m(e.prototype,r),n&&m(e,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),w=new g("champion","champion.png","champs");w.icon=w.sheet.crop(0,0,32,32);var E=new g("paladin","paladin.png","champs");E.icon=E.sheet.crop(0,0,32,32);var O=new g("fighter","fighter.png","champs");O.icon=O.sheet.crop(0,0,32,32);var T=new g("thief","thief.png","champs");T.icon=T.sheet.crop(0,0,32,32);var P=new g("wizard","wizard.png","champs");P.icon=P.sheet.crop(0,0,32,32);var _=new g("goblin","goblin.png","enemies");_.icon=_.sheet.crop(0,0,32,32);var k=new g("skeleton","skeleton.png","enemies");k.icon=k.sheet.crop(0,0,32,32);var A=new g("slime","slime.png","enemies");A.icon=A.sheet.crop(0,0,32,32);var R=new g("dragon","dragon.png","enemies");R.icon=R.sheet.crop(0,0,32,32);var j=new g("potion","potion.png","items");j.icon=j.sheet.crop(0,0,32,32);var C=new g("scroll","scroll.png","items");C.icon=C.sheet.crop(0,0,32,32);var x=new g("treasure-chest","treasure-chest.png","items");x.icon=x.sheet.crop(0,0,32,32);var I=new g("cursor","cursor.png");I.pointer=I.sheet.crop(0,0,49,56);var N=new g("black-banner","black-banner.png");N.icon=N.sheet.crop(0,0,64,64);var M=new g("white-banner","white-banner.png");function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function L(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==B(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==B(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===B(o)?o:String(o)),n)}var o}M.icon=M.sheet.crop(0,0,64,64);var H=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=null,this.y=null,this.bounds={x:-4,y:-4,width:8,height:8},this.assets={cursor:g.getAssets("cursor").pointer}}var e,r;return e=t,(r=[{key:"render",value:function(t){t.drawSprite(this.assets.cursor,this.x-2,this.y-1,32,32)}}])&&L(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function G(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==D(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===D(o)?o:String(o)),n)}var o}var W=function(){function t(e,r,n,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=r,this.width=n,this.height=o}var e,r;return e=t,(r=[{key:"intersects",value:function(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}}])&&G(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function K(t){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},K(t)}function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Y(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==K(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==K(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===K(o)?o:String(o)),n)}var o}var U=[],z=1,Z=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.lastEntityHovered=null,this.cursor=new H,this.entities=[]}var e,r;return e=t,r=[{key:"tick",value:function(t){for(var e=0;e<this.entities.length;e+=1)this.entities[e].tick(t)}},{key:"render",value:function(t){for(var e=0;e<this.entities.length;e+=1){var r=this.entities[e];r.dontRender||U.includes(r.type)||this.entities[e].render(t)}this.cursor.x&&this.cursor.y&&this.cursor.render(t)}},{key:"getSelectedChamps",value:function(){return this.entities.filter((function(t){return t.selected&&t.type===u.TYPES.CHAMP}))}},{key:"getSelectedEnemies",value:function(){return this.entities.filter((function(t){return t.selected&&t.type===u.TYPES.ENEMY}))}},{key:"addEntity",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.id=z,z+=1,e?this.entities.unshift(t):this.entities.push(t);var r=new W(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height);return this.handler.getWorld().getSpatialGrid().insert(r,t),t}},{key:"findEntityByName",value:function(t){return this.entities.find((function(e){return e.name===t}))}},{key:"removeEntity",value:function(t){this.handler.getWorld().getSpatialGrid().remove(new W(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height),t),this.entities=this.entities.filter((function(e){return e.id!==t.id})),t=void 0}},{key:"findClickableEntityAt",value:function(t,e){var r,n=new W(this.cursor.x+this.cursor.bounds.x,this.cursor.y+this.cursor.bounds.y,this.cursor.bounds.width,this.cursor.bounds.height);return(r=this.entities,function(t){if(Array.isArray(t))return F(t)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||function(t,e){if(t){if("string"==typeof t)return F(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F(t,e):void 0}}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).reverse().find((function(t){if(!t.bounds)throw new Error("entity type ".concat(t.type," has no bounds"));var e=new W(t.x+t.bounds.x,t.y+t.bounds.y,t.bounds.width,t.bounds.height);return n.intersects(e)}))}},{key:"findEntityByType",value:function(t){return this.entities.filter((function(e){return e.type===t}))}},{key:"mouseClick",value:function(t){var e=t.x,r=t.y,n=this.findClickableEntityAt(e,r);n&&n.wasClickedAt&&n.wasClickedAt(e,r)}},{key:"mouseMove",value:function(t){var e=t.x,r=t.y;this.cursor.x=e,this.cursor.y=r;var n=this.findClickableEntityAt(e,r);n?n&&this.lastEntityHovered&&n.id===this.lastEntityHovered.id||(this.lastEntityHovered&&this.lastEntityHovered.wasBlurred&&this.lastEntityHovered.wasBlurred(),n.wasHoveredAt&&n.wasHoveredAt(e,r),this.lastEntityHovered=n):this.lastEntityHovered&&this.lastEntityHovered.wasBlurred&&(this.lastEntityHovered.wasBlurred(),this.lastEntityHovered=null)}},{key:"getEntitiesByType",value:function(t){return this.entities.filter((function(e){return e.type==t}))}}],r&&Y(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function V(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==X(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==X(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===X(o)?o:String(o)),n)}var o}var q=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,(r=[{key:"construct",value:function(){this.currentState=null}},{key:"getState",value:function(){return this.currentState}},{key:"setState",value:function(t){this.currentState=t}}])&&V(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $(t){return $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$(t)}function J(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==$(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==$(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===$(o)?o:String(o)),n)}var o}var Q=function(){function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.width=parseInt(e/n),this.height=parseInt(r/n),this.size=n,this.grid=[];for(var o=0;o<=this.width;o++){this.grid[o]=[];for(var i=0;i<=this.height;i++)this.grid[o][i]=[]}}var e,r;return e=t,(r=[{key:"insert",value:function(t,e){for(var r=Math.max(0,parseInt(t.x/this.size)),n=Math.max(0,parseInt(t.y/this.size)),o=Math.min(this.width,parseInt((t.x+t.width)/this.size)),i=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=n;a<=i;a++)for(var u=r;u<=o;u++)-1===this.grid[u][a].indexOf(e)&&this.grid[u][a].push(e)}},{key:"retrieve",value:function(t,e){for(var r=Math.max(0,parseInt(t.x/this.size)),n=Math.max(0,parseInt(t.y/this.size)),o=Math.min(this.width,parseInt((t.x+t.width)/this.size)),i=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=[],u=n;u<=i;u++)for(var c=r;c<=o;c++)this.grid[c][u].forEach((function(t){t!==e&&-1===a.indexOf(t)&&a.push(t)}));return a}},{key:"remove",value:function(t,e){for(var r=Math.max(0,parseInt(t.x/this.size)),n=Math.max(0,parseInt(t.y/this.size)),o=Math.min(this.width,parseInt((t.x+t.width)/this.size)),i=Math.min(this.height,parseInt((t.y+t.height)/this.size)),a=n;a<=i;a++)for(var u=r;u<=o;u++)for(var c=0;c<this.grid[u][a].length;c++)this.grid[u][a][c]===e&&this.grid[u][a].splice(c,1)}},{key:"reset",value:function(){for(var t=0;t<=this.width;t++){this.grid[t]=[];for(var e=0;e<=this.height;e++)this.grid[t][e]=[]}}},{key:"getWidth",value:function(){return this.width}},{key:"getHeight",value:function(){return this.height}},{key:"getSize",value:function(){return this.size}},{key:"render",value:function(t){for(var e=0;e<=this.height;e++)for(var r=0;r<=this.width;r++){var n=r*this.size,o=e*this.size;t.fillStyle="orange",t.strokeRect(n,o,this.size,this.size),this.grid[r][e].length>0&&(t.fillStyle="yellow",t.fillRect(n,o,this.size,this.size))}}}])&&J(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==tt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===tt(o)?o:String(o)),n)}var o}var rt=[u.TYPES.GARDEN,u.TYPES.PLOT,u.TYPES.LANE],nt=function(){function t(e,r,n,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.x=r,this.y=n,this.width=o,this.height=i,this.id=null,this.index=null,this.bounds=new W(0,0,this.width,this.height)}var e,r;return e=t,r=[{key:"tick",value:function(){throw new Error("".concat(this.constructor.name," did not implement tick() method"))}},{key:"getCollisionBounds",value:function(t,e){var r=parseInt(this.x+this.bounds.x+t,10),n=parseInt(this.y+this.bounds.y+e);return new W(r,n,this.bounds.width,this.bounds.height)}},{key:"checkEntityCollisions",value:function(t,e){var r=this.handler.getWorld().getSpatialGrid().retrieve(new W(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height),this);r=r.filter((function(t){return!rt.includes(t.type)}));for(var n=0;n<r.length;n++)if(r[n].getCollisionBounds(0,0).intersects(this.getCollisionBounds(t,e)))return!0;return!1}},{key:"drawCollisionBounds",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"blue";t.fillStyle=e,t.fillRect(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height)}},{key:"setDefaultBounds",value:function(){this.bounds={x:8,y:0,width:this.width-16,height:this.height}}},{key:"destroySelf",value:function(){this.handler.getEntityManager().removeEntity(this)}}],r&&et(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function ot(t){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ot(t)}function it(t,e){return it=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},it(t,e)}function at(t){return at=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},at(t)}var ut=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&it(t,e)}(i,t);var e,r,n,o=(r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=at(r);if(n){var o=at(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e,r,n,a){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(u=o.call(this,t,e,r,n,a)).handler=t,u}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(nt);function ct(t){return ct="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct(t)}function st(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ct(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ct(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ct(o)?o:String(o)),n)}var o}function lt(t,e){return lt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lt(t,e)}function ft(t){return ft=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ft(t)}var yt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ft(n);if(o){var r=ft(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ct(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this,t,u.DIALOGUE.X,u.DIALOGUE.Y)).x=u.DIALOGUE.X,r.y=u.DIALOGUE.Y,r.width=u.DIALOGUE.WIDTH,r.height=u.DIALOGUE.HEIGHT,r.bounds={x:-r.x,y:-r.y,width:u.GAME_WIDTH,height:u.GAME_HEIGHT},r.fontSize=30,r.textX=r.x+r.fontSize,r.textY=r.y+r.height/2+r.fontSize/3,r.type=u.TYPES.INTERACTIVE,r.dialogue="",r.speechTimer=5,r.wasClicked=!1,r.isRobot=n,r.words=[],r.soundManager=r.handler.getSoundManager(),r.nextCounter=0,r.nextCounterMax=70,r.soundCounter=0,r.soundCounterMax=2,r.addWords(e),r}return e=a,(r=[{key:"tick",value:function(){if(!this.words.length)return this.handler.getWorld().dialogueFinished(),void this.handler.getEntityManager().removeEntity(this);this.speechTimer>=2&&this.words.length&&(this.words[0].length?(this.soundCounter+=1,this.soundCounter>this.soundCounterMax&&(this.soundManager.speak(this.isRobot),this.soundCounter=0),this.sayNextLetter()):this.wasClicked&&(this.wasClicked=!1,this.readNextSentence())),this.speechTimer<30&&this.speechTimer++}},{key:"render",value:function(t){this.words[0]&&(t.fillStyle="black",t.globalAlpha=.6,t.fillRect(this.x+this.bounds.x,this.y+this.bounds.y,this.bounds.width,this.bounds.height),t.globalAlpha=1,t.fillStyle="white",t.fillRect(this.x,this.y,this.width,this.height),t.drawText(this.dialogue,this.textX,this.textY,"black",!1,this.fontSize),this.words[0].length||(this.nextCounter+=1,this.nextCounter<this.nextCounterMax/2&&t.drawText(">",this.x+this.width-64,this.y+this.height-16,"black",!1,48),this.nextCounter>=this.nextCounterMax&&(this.nextCounter=0)))}},{key:"readNextSentence",value:function(){this.words.splice(0,1),this.clean()}},{key:"clean",value:function(){this.dialogue="",this.sentencePause=0}},{key:"sayNextLetter",value:function(){var t=this.words[0][0];this.dialogue+=t,this.words[0].splice(0,1),this.speechTimer=0}},{key:"addWords",value:function(t){var e=this;t instanceof Array||(t=[t]),t.forEach((function(t){e.words.push(t.split(""))}))}},{key:"clear",value:function(){this.words=[],this.clean()}},{key:"wasClickedAt",value:function(){this.words[0].length||(this.wasClicked=!0)}}])&&st(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(ut);function ht(t){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ht(t)}function pt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ht(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ht(o)?o:String(o)),n)}var o}function bt(t,e){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bt(t,e)}function dt(t){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dt(t)}var vt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=dt(n);if(o){var r=dt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.width=64,c.height=64,c.index=null,c.bannerAssets=g.getAssets("white-banner"),c.type=u.TYPES.CHAMP;var s=c.handler.getWorld();return c.clickableInStates=[s.STATES.CHOOSE_ATTACKING_CHAMP,s.STATES.CHOOSE_BANNERS_TO_REROLL],c.selected=!1,c}return e=a,(r=[{key:"canBeSelectedInCurrentState",value:function(){var t=this.handler.getWorld();return this.clickableInStates.includes(t.state)}},{key:"getDisplayName",value:function(){throw new Error('Hero must have a "getDisplayName()" method!')}},{key:"wasClickedAt",value:function(t,e){if(console.log("champ clicked: ",this.index,this.id,this.getDisplayName()),this.canBeSelectedInCurrentState()){var r=this.handler.getWorld();switch(r.state){case r.STATES.CHOOSE_BANNERS_TO_REROLL:this.selected?this.handler.getWorld().removeSelectedChamp(this):this.handler.getWorld().addSelectedChamp(this);break;case r.STATES.CHOOSE_ATTACKING_CHAMP:r.setAttackingChamp(this);break;default:throw new Error("Unexpected state in champ.wasClickedAt() => ".concat(r.state))}}}},{key:"tick",value:function(t){}},{key:"canKillAllOfSubType",value:function(t){return this.killsAllOfSubTypes.includes(t)}},{key:"render",value:function(t){this.selected&&(t.fillStyle=this.attacking?"red":"grey",t.fillRect(this.x-0,this.y-8,this.width,this.height+16)),t.drawSprite(this.bannerAssets.icon,this.x,this.y,this.width,this.height),t.drawSprite(this.assets.icon,this.x+16,this.y+8,this.width/2,this.height/2)}},{key:"getAnimationFrame",value:function(){return this.assets.animations.icon.getCurrentFrame()}}])&&pt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);function mt(t){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mt(t)}function St(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==mt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===mt(o)?o:String(o)),n)}var o}function gt(t,e){return gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},gt(t,e)}function wt(t){return wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},wt(t)}var Et=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&gt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=wt(n);if(o){var r=wt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===mt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("champion"),c.killsAllOfSubTypes=[u.BLACK_BANNERS.GOBLIN,u.BLACK_BANNERS.SKELETON,u.BLACK_BANNERS.SLIME],c.setDefaultBounds(),c}return e=a,(r=[{key:"getDisplayName",value:function(){return"Champion"}}])&&St(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(vt);function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function Tt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ot(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ot(o)?o:String(o)),n)}var o}function Pt(t,e){return Pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pt(t,e)}function _t(t){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_t(t)}var kt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_t(n);if(o){var r=_t(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ot(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("fighter"),c.killsAllOfSubTypes=[u.BLACK_BANNERS.GOBLIN],c.setDefaultBounds(),c}return e=a,(r=[{key:"getDisplayName",value:function(){return"Fighter"}}])&&Tt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(vt);function At(t){return At="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},At(t)}function Rt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==At(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==At(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===At(o)?o:String(o)),n)}var o}function jt(t,e){return jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jt(t,e)}function Ct(t){return Ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ct(t)}var xt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ct(n);if(o){var r=Ct(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===At(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("paladin"),c.killsAllOfSubTypes=[u.BLACK_BANNERS.SKELETON],c.setDefaultBounds(),c}return e=a,(r=[{key:"getDisplayName",value:function(){return"Paladin"}}])&&Rt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(vt);function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function Nt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==It(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==It(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===It(o)?o:String(o)),n)}var o}function Mt(t,e){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Mt(t,e)}function Bt(t){return Bt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Bt(t)}var Lt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Mt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Bt(n);if(o){var r=Bt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===It(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(u=i.call(this,t,e,r,n,o)).handler=t,u.x=e,u.y=r,u.assets=g.getAssets("thief"),u.killsAllOfSubTypes=[],u.setDefaultBounds(),u}return e=a,(r=[{key:"getDisplayName",value:function(){return"Thief"}}])&&Nt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(vt);function Ht(t){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ht(t)}function Dt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ht(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ht(o)?o:String(o)),n)}var o}function Gt(t,e){return Gt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Gt(t,e)}function Wt(t){return Wt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Wt(t)}var Kt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Wt(n);if(o){var r=Wt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ht(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("wizard"),c.killsAllOfSubTypes=[u.BLACK_BANNERS.SLIME],c.setDefaultBounds(),c}return e=a,(r=[{key:"getDisplayName",value:function(){return"Wizard"}}])&&Dt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(vt);function Ft(t){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ft(t)}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ft(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ft(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ft(o)?o:String(o)),n)}var o}function Ut(t,e){return Ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ut(t,e)}function zt(t){return zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zt(t)}var Zt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ut(t,e)}(c,t);var e,r,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=zt(o);if(i){var r=zt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ft(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function c(t,e,r,n,o){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(i=a.call(this,t,e,r,n,o)).handler=t,i.x=e,i.y=r,i.width=64,i.height=64,i.bannerAssets=g.getAssets("black-banner"),i.type=u.TYPES.ENEMY;var s=i.handler.getWorld();return i.clickableInStates=[s.STATES.CHOOSE_MONSTER_TO_ATTACK,s.STATES.CHOOSE_BANNERS_TO_REROLL],i.selected=!1,i}return e=c,n=[{key:"getDisplayName",value:function(){throw new Error('Enemy must have a "getDisplayName()" method!')}}],(r=[{key:"canBeSelectedInCurrentState",value:function(){var t=this.handler.getWorld();return this.clickableInStates.includes(t.state)}},{key:"addOrRemoveSelectedEnemy",value:function(){this.selected?this.handler.getWorld().removeSelectedEnemy(this):this.handler.getWorld().addSelectedEnemy(this)}},{key:"wasClickedAt",value:function(t,e){if(console.log("enemy clicked: ",this.index,this.id,this.getDisplayName()),this.canBeSelectedInCurrentState()){var r=this.handler.getWorld();switch(r.state){case r.STATES.CHOOSE_BANNERS_TO_REROLL:this.addOrRemoveSelectedEnemy();break;case r.STATES.CHOOSE_MONSTER_TO_ATTACK:this.selected?r.removeSelectedEnemy(this):r.tryAddEnemyToSelected(this);break;default:throw new Error("Unexpected state in champ.wasClickedAt() => ".concat(r.state))}}}},{key:"tick",value:function(t){}},{key:"render",value:function(t){this.selected&&(t.fillStyle="grey",t.fillRect(this.x-0,this.y-8,this.width,this.height+16)),t.drawSprite(this.bannerAssets.icon,this.x,this.y,this.width,this.height),t.drawSprite(this.assets.icon,this.x+16,this.y+8,this.width/2,this.height/2)}},{key:"getAnimationFrame",value:function(){return this.assets.animations.icon.getCurrentFrame()}}])&&Yt(e.prototype,r),n&&Yt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(nt);function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Xt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Xt(o)?o:String(o)),n)}var o}function qt(t,e){return qt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},qt(t,e)}function $t(t){return $t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},$t(t)}var Jt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&qt(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=$t(n);if(o){var r=$t(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("goblin"),c.subType=u.BLACK_BANNERS.GOBLIN,c.setDefaultBounds(),c}return e=a,(r=[{key:"getDisplayName",value:function(){return"Goblin"}}])&&Vt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(Zt);function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Qt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Qt(o)?o:String(o)),n)}var o}function ee(t,e){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ee(t,e)}function re(t){return re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},re(t)}var ne=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ee(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=re(n);if(o){var r=re(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Qt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("skeleton"),c.subType=u.BLACK_BANNERS.SKELETON,c.setDefaultBounds(),c}return e=a,(r=[{key:"getDisplayName",value:function(){return"Skeleton"}}])&&te(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(Zt);function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==oe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===oe(o)?o:String(o)),n)}var o}function ae(t,e){return ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ae(t,e)}function ue(t){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ue(t)}var ce=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ae(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ue(n);if(o){var r=ue(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("slime"),c.subType=u.BLACK_BANNERS.SLIME,c.setDefaultBounds(),c}return e=a,(r=[{key:"getDisplayName",value:function(){return"Slime"}}])&&ie(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(Zt);function se(t){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},se(t)}function le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==se(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==se(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===se(o)?o:String(o)),n)}var o}function fe(t,e){return fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},fe(t,e)}function ye(t){return ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ye(t)}var he=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&fe(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ye(n);if(o){var r=ye(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===se(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("dragon"),c.subType=u.BLACK_BANNERS.DRAGON,c.setDefaultBounds(),c}return e=a,(r=[{key:"getDisplayName",value:function(){return"Dragon"}}])&&le(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(Zt);function pe(t){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pe(t)}function be(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==pe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===pe(o)?o:String(o)),n)}var o}function de(t,e){return de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},de(t,e)}function ve(t){return ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ve(t)}var me=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&de(t,e)}(c,t);var e,r,n,o,i,a=(o=c,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ve(o);if(i){var r=ve(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===pe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function c(t,e,r,n,o){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(i=a.call(this,t,e,r,n,o)).handler=t,i.x=e,i.y=r,i.width=64,i.height=64,i.type=u.TYPES.ITEM,i.selected=!1,i}return e=c,n=[{key:"getDisplayName",value:function(){throw new Error('Item must have a "getDisplayName()" method!')}}],(r=[{key:"canBeSelectedInCurrentState",value:function(){throw new Error("Can be selected in current state not implemented for above ^")}},{key:"wasClickedAt",value:function(){console.log("item clicked: ",this.index,this.id,this.getDisplayName()),this.canBeSelectedInCurrentState()&&(this.selected?this.type===u.TYPES.BLACK_ITEM?this.handler.getWorld().removeSelectedEnemy(this):this.handler.getWorld().removeSelectedChamp(this):this.type===u.TYPES.BLACK_ITEM?this.handler.getWorld().addSelectedEnemy(this):this.handler.getWorld().addSelectedChamp(this))}},{key:"tick",value:function(t){}},{key:"render",value:function(t){this.selected&&(t.fillStyle="grey",t.fillRect(this.x-0,this.y-8,this.width,this.height+16)),t.drawSprite(this.bannerAssets.icon,this.x,this.y,this.width,this.height),t.drawSprite(this.assets.icon,this.x+16,this.y+8,this.width/2,this.height/2)}},{key:"getAnimationFrame",value:function(){return this.assets.animations.icon.getCurrentFrame()}}])&&be(e.prototype,r),n&&be(e,n),Object.defineProperty(e,"prototype",{writable:!1}),c}(nt);function Se(t){return Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Se(t)}function ge(t,e){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ge(t,e)}function we(t){return we=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},we(t)}var Ee=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ge(t,e)}(i,t);var e,r,n,o=(r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=we(r);if(n){var o=we(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Se(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e,r,n,a){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(c=o.call(this,t,e,r,n,a)).bannerAssets=g.getAssets("black-banner"),c.type=u.TYPES.BLACK_ITEM,c}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(me);function Oe(t){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oe(t)}function Te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Oe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Oe(o)?o:String(o)),n)}var o}function Pe(t,e){return Pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Pe(t,e)}function _e(t){return _e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_e(t)}var ke=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Pe(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_e(n);if(o){var r=_e(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Oe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("potion"),c.subType=u.BLACK_BANNERS.POTION,c.setDefaultBounds();var s=c.handler.getWorld();return c.clickableInStates=[s.STATES.CHOOSE_BANNERS_TO_REROLL],c}return e=a,(r=[{key:"canBeSelectedInCurrentState",value:function(){var t=this.handler.getWorld();return this.clickableInStates.includes(t.state)}},{key:"getDisplayName",value:function(){return"Potion"}}])&&Te(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ee);function Ae(t){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ae(t)}function Re(t,e){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Re(t,e)}function je(t){return je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},je(t)}function Ce(t){return Ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ce(t)}function xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ce(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ce(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ce(o)?o:String(o)),n)}var o}function Ie(t,e){return Ie=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ie(t,e)}function Ne(t){return Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ne(t)}var Me=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ie(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Ne(n);if(o){var r=Ne(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ce(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(u=i.call(this,t,e,r,n,o)).handler=t,u.x=e,u.y=r,u.assets=g.getAssets("scroll"),u.setDefaultBounds();var c=u.handler.getWorld();return u.clickableInStates=[c.STATES.USE_SCROLLS,c.STATES.CHOOSE_BANNERS_TO_REROLL],u}return e=a,(r=[{key:"getDisplayName",value:function(){return"Scroll"}},{key:"canBeSelectedInCurrentState",value:function(){var t=this.handler.getWorld();return(t.state!==t.STATES.CHOOSE_BANNERS_TO_REROLL||!t.selectedRerollScroll||t.selectedRerollScroll.id!==this.id)&&this.clickableInStates.includes(t.state)}},{key:"wasClickedAt",value:function(){if(this.canBeSelectedInCurrentState()){var t=this.handler.getWorld();switch(t.state){case t.STATES.USE_SCROLLS:t.assignRerollScroll(this);break;case t.STATES.CHOOSE_BANNERS_TO_REROLL:this.selected?t.removeSelectedChamp(this):t.addSelectedChamp(this);break;default:throw new Error("unexpected state in scroll.wasClickedAt() => ".concat(t.state))}}}},{key:"whenSelected",value:function(){var t=this.handler.getWorld();t.selectedRerollScroll=this,t.state=t.STATES.CHOOSE_BANNERS_TO_REROLL}}])&&xe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Re(t,e)}(i,t);var e,r,n,o=(r=i,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=je(r);if(n){var o=je(this).constructor;t=Reflect.construct(e,arguments,o)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ae(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function i(t,e,r,n,a){var c;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(c=o.call(this,t,e,r,n,a)).bannerAssets=g.getAssets("white-banner"),c.type=u.TYPES.WHITE_ITEM,c}return e=i,Object.defineProperty(e,"prototype",{writable:!1}),e}(me));function Be(t){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Be(t)}function Le(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Be(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Be(o)?o:String(o)),n)}var o}function He(t,e){return He=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},He(t,e)}function De(t){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},De(t)}var Ge=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&He(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=De(n);if(o){var r=De(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Be(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var c;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(c=i.call(this,t,e,r,n,o)).handler=t,c.x=e,c.y=r,c.assets=g.getAssets("treasure-chest"),c.subType=u.BLACK_BANNERS.TREASURE_CHEST,c.setDefaultBounds();var s=c.handler.getWorld();return c.clickableInStates=[s.STATES.CHOOSE_BANNERS_TO_REROLL],c}return e=a,(r=[{key:"canBeSelectedInCurrentState",value:function(){var t=this.handler.getWorld();return this.clickableInStates.includes(t.state)}},{key:"getDisplayName",value:function(){return"Treasure Chest"}}])&&Le(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ee);function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function Ke(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Fe(n.key),n)}}function Fe(t){var e=function(t,e){if("object"!==We(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==We(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===We(e)?e:String(e)}var Ye=function(){function t(e){var r,n,o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=function(){return i.party},(n=Fe(n="getParty"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,this.handler=e,this.party=[],this.width=null,this.padding=null,this.height=null,this.x=null,this.y=null,this.backgroundColor=null}var e,r;return e=t,(r=[{key:"addToParty",value:function(t){this.setPartyMemberPosition(t),this.party.push(t)}},{key:"setPartyIndexes",value:function(){this.party.forEach((function(t,e){t.index=e}))}},{key:"removeFromParty",value:function(t){this.party=this.party.filter((function(e){return t.id!==e.id})),this.setPartyIndexes()}},{key:"clearParty",value:function(){this.party=[]}},{key:"setAllPartyMembersPositions",value:function(){var t=this;this.party.forEach((function(e){t.setPartyMemberPosition(e)}))}},{key:"replaceRerolledPartyMembers",value:function(t){var e=this;this.party=this.party.map((function(r){return t.forEach((function(t){r.id===t.id&&(t.index=r.index,t.id=-1,e.handler.getWorld().entityManager.removeEntity(r),t.id=r.id,r=t)})),r})).reverse(),this.sendAllDragonsToLair(),this.setPartyIndexes(),this.setAllPartyMembersPositions()}},{key:"sendAllDragonsToLair",value:function(){for(var t=0;t<this.party.length;t++){var e=this.party[t];e&&e.subType===u.BLACK_BANNERS.DRAGON&&this.addToDragonsLair(e)}}},{key:"render",value:function(t){t.fillStyle=this.backgroundColor,t.fillRect(this.x,this.y,this.width,this.height),this.party.forEach((function(e){e.render(t)})),t.drawText("Enemy Party:",this.x+this.padding,this.y-2*this.padding,this.textColor,!0,u.BIG_FONT_SIZE)}},{key:"setPartyMemberPosition",value:function(t){t.x=this.x+this.padding+t.width*t.index+this.padding,t.y=this.y+this.padding}}])&&Ke(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ue(t){return Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ue(t)}function ze(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ue(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ue(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ue(o)?o:String(o)),n)}var o}function Ze(t,e){return Ze=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ze(t,e)}function Xe(t){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Xe(t)}var Ve=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ze(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Xe(n);if(o){var r=Xe(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===Ue(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,t)).width=480,e.padding=8,e.height=64+2*e.padding,e.x=u.GAME_WIDTH/2-e.width/2,e.y=u.GAME_HEIGHT/2+112,e.backgroundColor=u.COLORS.DARK_PURPLE,e.textColor=u.COLORS.DARK_PURPLE,e.graveYard=null,e}return e=a,(r=[{key:"setGraveYard",value:function(t){this.graveYard=t}},{key:"sendToGraveyard",value:function(t){this.graveYard.addMember(t),this.removeFromParty(t)}},{key:"hasScrollInParty",value:function(){return this.party.filter((function(t){return t.type===u.TYPES.WHITE_ITEM})).length>0}}])&&ze(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ye);function qe(t){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qe(t)}function $e(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==qe(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==qe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===qe(o)?o:String(o)),n)}var o}function Je(t,e){return Je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Je(t,e)}function Qe(t){return Qe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Qe(t)}var tr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Je(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Qe(n);if(o){var r=Qe(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===qe(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(u=i.call(this,t,e,r,n,o)).padding=8,u.party=[],u}return e=a,(r=[{key:"render",value:function(t){t.fillStyle=u.COLORS.RED,t.fillRect(this.x,this.y,this.width,this.height),t.drawText("Dragon's Lair:",this.x+this.padding,this.y-2*this.padding,u.COLORS.RED,!0,u.BIG_FONT_SIZE),this.party.forEach((function(e){e.render(t)}))}},{key:"tick",value:function(){}},{key:"addMember",value:function(t){if(this.party.push(t),this.setPartyIndexes(),this.setPartyMemberPosition(this.party[this.party.length-1]),3===this.party.length){alert("Dragon attacks!");var e=this.handler.getWorld();e.state=e.STATES.DRAGON_ATTACKS}this.party.length>3&&(this.party=this.party.slice(0,3))}},{key:"setPartyMemberPosition",value:function(t){t.x=this.x+this.padding/2+t.width*(t.index%4)+this.padding/2,t.y=this.y+this.padding,t.index>3&&(t.y=t.y+96)}},{key:"setPartyIndexes",value:function(){this.party.forEach((function(t,e){t.index=e}))}}])&&$e(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);function er(t){return er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},er(t)}function rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==er(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==er(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===er(o)?o:String(o)),n)}var o}function nr(t,e){return nr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nr(t,e)}function or(t){return or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},or(t)}var ir=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nr(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=or(n);if(o){var r=or(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===er(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t,e,r,n,o){var u;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(u=i.call(this,t,e,r,n,o)).padding=8,u.party=[],u}return e=a,(r=[{key:"render",value:function(t){t.fillStyle=u.COLORS.GREY,t.fillRect(this.x,this.y-this.padding,this.width,this.height),t.drawText("Grave Yard:",this.x+this.padding,this.y-2*this.padding,u.COLORS.GREY,!0,u.BIG_FONT_SIZE),this.party.forEach((function(e){e.render(t)}))}},{key:"tick",value:function(){}},{key:"addMember",value:function(t){this.party.push(t),this.setPartyIndexes(),this.setPartyMemberPosition(this.party[this.party.length-1])}},{key:"setPartyMemberPosition",value:function(t){t.x=this.x+this.padding/2+t.width*(t.index%4)+this.padding/2,t.y=this.y+this.padding,t.index>3&&(t.y=t.y+96)}},{key:"setPartyIndexes",value:function(){this.party.forEach((function(t,e){t.index=e}))}}])&&rr(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(nt);function ar(t){return ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ar(t)}function ur(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==ar(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===ar(o)?o:String(o)),n)}var o}function cr(t,e){return cr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},cr(t,e)}function sr(t){return sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sr(t)}var lr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&cr(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=sr(n);if(o){var r=sr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===ar(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,t)).width=480,e.padding=8,e.height=64+2*e.padding,e.x=u.GAME_WIDTH/2-e.width/2,e.y=64,e.backgroundColor=u.COLORS.LIGHT_PURPLE,e.textColor=u.COLORS.LIGHT_PURPLE,e.dragonsLair=null,e}return e=a,(r=[{key:"setDragonsLair",value:function(t){this.dragonsLair=t}},{key:"addToDragonsLair",value:function(t){this.dragonsLair.addMember(t),this.removeFromParty(t)}},{key:"removeAttackedMonsters",value:function(t){var e=t.map((function(t){return t.id}));this.party=this.party.filter((function(t){return!e.includes(t.id)})),this.setPartyIndexes(),this.setAllPartyMembersPositions()}},{key:"sendAllDragonsToLair",value:function(){for(var t=0;t<this.party.length;t++){var e=this.party[t];e&&e.subType===u.BLACK_BANNERS.DRAGON&&this.addToDragonsLair(e)}}}])&&ur(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(Ye);function fr(t){return fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(t)}function yr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==fr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===fr(o)?o:String(o)),n)}var o}function hr(t,e){return hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},hr(t,e)}function pr(t){return pr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},pr(t)}var br=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&hr(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=pr(n);if(o){var r=pr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===fr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,t)).handler=t,e.x=u.GAME_WIDTH-192-64+16,e.y=u.GAME_HEIGHT/2+112+8,e.width=192,e.height=64,e.bounds={x:0,y:0,width:e.width,height:e.height},e.padding=12,e.type=u.TYPES.STATIC_BUTTON;var r=e.handler.getWorld();return e.clickableInStates=[r.STATES.USE_SCROLLS,r.STATES.CHOOSE_BANNERS_TO_REROLL,r.STATES.USE_HERO_POWER],e}return e=a,(r=[{key:"tick",value:function(){}},{key:"wasClickedAt",value:function(t,e){this.canBeSelectedInCurrentState()&&this.handler.getWorld().skipPhaseClicked()}},{key:"canBeSelectedInCurrentState",value:function(){var t=this.handler.getWorld();return this.clickableInStates.includes(t.state)}},{key:"wasHoveredAt",value:function(t,e){}},{key:"wasBlurred",value:function(){}},{key:"render",value:function(t){this.canBeSelectedInCurrentState()&&(t.fillStyle=u.COLORS.DARK_PURPLE,t.fillRect(this.x,this.y,this.width,this.height),t.drawText("Skip Phase",this.x+this.padding,this.y+this.height/2+12,u.COLORS.CREAM,!0,u.BIG_FONT_SIZE))}}])&&yr(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(ut);function dr(t){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dr(t)}function vr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==dr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===dr(o)?o:String(o)),n)}var o}function mr(t,e){return mr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mr(t,e)}function Sr(t){return Sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Sr(t)}var gr=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&mr(t,e)}(a,t);var e,r,n,o,i=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Sr(n);if(o){var r=Sr(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===dr(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=i.call(this,t)).handler=t,e.x=48,e.y=u.GAME_HEIGHT/2+112+8,e.width=192,e.height=64,e.bounds={x:0,y:0,width:e.width,height:e.height},e.padding=12,e.type=u.TYPES.ACTION_BUTTON,e.action=null,e}return e=a,(r=[{key:"tick",value:function(){}},{key:"setAction",value:function(t){this.action=t}},{key:"clearAction",value:function(){this.action=null}},{key:"wasClickedAt",value:function(t,e){this.handler.getWorld().actionTaken(this.action)}},{key:"wasHoveredAt",value:function(t,e){}},{key:"wasBlurred",value:function(){}},{key:"render",value:function(t){this.action&&(t.fillStyle=u.COLORS.DARK_PURPLE,t.fillRect(this.x,this.y,this.width,this.height),t.drawText(this.action,this.x+this.padding,this.y+this.height/2+12,u.COLORS.CREAM,!0,u.BIG_FONT_SIZE))}}])&&vr(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(ut);function wr(t){return wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wr(t)}function Er(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Or(n.key),n)}}function Or(t){var e=function(t,e){if("object"!==wr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==wr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===wr(e)?e:String(e)}var Tr=function(){function t(e){var r,n,o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,o=function(){return i.entityManager.findEntityByType(u.TYPES.ACTION_BUTTON)[0]},(n=Or(n="findActionButton"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,this.handler=e,this.entityManager=e.createEntityManager(),this.spatialGrid=new Q(u.GAME_WIDTH,u.GAME_HEIGHT,u.SPATIAL_GRID_SIZE),this.STATES={CHOOSE_MONSTER_TO_ATTACK:"choose-monster-to-attack",CHOOSE_ATTACKING_CHAMP:"choose-attacking-champ",CHOOSE_BANNERS_TO_REROLL:"choose-banners-to-reroll",DRAGON_ATTACKS:"dragon-attacks",GAME_WON:"game-won",INITIALIZE:"initialize",INTRO:"intro",IDLE:"idle",ROLL_ENEMIES:"roll-enemies",TEST:"test",TEST_INIT:"test-init",USE_SCROLLS:"use-scrolls",USE_HERO_POWER:"use-hero-power"},this.state=this.STATES.INITIALIZE,this.player=new Ve(e),this.enemyParty=new lr(e),this.clearSelectedEntities()}var e,r;return e=t,(r=[{key:"assignRerollScroll",value:function(t){this.selectedRerollScroll&&(this.selectedRerollScroll.selected=!1),t.selected=!0,this.selectedRerollScroll=t}},{key:"clearSelectedEntities",value:function(){this.selectedEnemies=[],this.selectedChamps=[],this.selectedRerollScroll=null,this.attackingChamp=null}},{key:"createDialogue",value:function(t){this.dialogue=this.entityManager.addEntity(new yt(this.handler,t,!0))}},{key:"initDialogue",value:function(){}},{key:"gameWon",value:function(){this.state=this.STATES.GAME_WON}},{key:"dialogueFinished",value:function(){switch(this.state){case this.STATES.INITIALIZE:case this.STATES.IDLE:break;case this.STATES.INTRO:case this.STATES.GAME_WON:this.state=this.STATES.IDLE;break;default:throw new Error('World One dialogue finished state "'.concat(this.state," is not accounted for"))}}},{key:"tryAddEnemyToSelected",value:function(t){var e=this;if(0!==this.selectedEnemies.length){var r=this.selectedEnemies[0];r.subType===t.subType?this.attackingChamp.canKillAllOfSubType(r.subType)?this.addSelectedEnemy(t):alert("".concat(this.attackingChamp.getDisplayName()," can only kill one ").concat(r.subType," at a time.")):alert("You can only attack one type of enemy at a time.")}else{if(this.addSelectedEnemy(t),this.findActionButton().setAction(u.ACTIONS.ATTACK),!this.attackingChamp.canKillAllOfSubType(t.subType))return;this.enemyParty.getParty().forEach((function(r){r.subType===t.subType&&r.id!==t.id&&e.addSelectedEnemy(r)}))}}},{key:"setAttackingChamp",value:function(t){t.selected=!0,t.attacking=!0,this.attackingChamp=t,this.state=this.STATES.CHOOSE_MONSTER_TO_ATTACK}},{key:"loadEntities",value:function(){this.entityManager.addEntity(new gr(this.handler)),this.entityManager.addEntity(new br(this.handler))}},{key:"rollEnemy",value:function(t,e){var r,n=Object.keys(u.BLACK_BANNERS).map((function(t){return u.BLACK_BANNERS[t]})),o=rndIndex(n);switch(o){case u.BLACK_BANNERS.DRAGON:r=new he(this.handler);break;case u.BLACK_BANNERS.GOBLIN:r=new Jt(this.handler);break;case u.BLACK_BANNERS.SKELETON:r=new ne(this.handler);break;case u.BLACK_BANNERS.SLIME:r=new ce(this.handler);break;case u.BLACK_BANNERS.POTION:r=new ke(this.handler);break;case u.BLACK_BANNERS.TREASURE_CHEST:r=new Ge(this.handler);break;default:throw new Error("Default case hit for BLACK_BANNERS entity switch. Value: ".concat(o))}return r.index=t,r.dontRender=!0,r}},{key:"rollEnemies",value:function(){this.enemyParty.clearParty();for(var t=0;t<7;t++){var e=this.rollEnemy(t);this.entityManager.addEntity(e),e.subType===u.BLACK_BANNERS.DRAGON?this.enemyParty.addToDragonsLair(e):this.enemyParty.addToParty(e)}this.enemyParty.setPartyIndexes(),this.enemyParty.setAllPartyMembersPositions()}},{key:"tick",value:function(t){switch(this.state){case this.STATES.TEST_INIT:case this.STATES.TEST:break;case this.STATES.INITIALIZE:this.init(),this.state=this.STATES.ROLL_ENEMIES;break;case this.STATES.ROLL_ENEMIES:this.rollEnemies(),this.clearSelectedEntities(),this.state=this.STATES.USE_SCROLLS;break;case this.STATES.USE_SCROLLS:if(this.player.hasScrollInParty()||(this.clearSelectedEntities(),this.state=this.STATES.USE_HERO_POWER),this.selectedRerollScroll){var e=this.findActionButton();if(!e)throw new Error("Action Button type not found!");e.setAction(u.ACTIONS.REROLL),this.state=this.STATES.CHOOSE_BANNERS_TO_REROLL}break;case this.STATES.USE_HERO_POWER:this.state=this.STATES.CHOOSE_ATTACKING_CHAMP;break;case this.STATES.CHOOSE_ATTACKING_CHAMP:this.selectedBanner&&(this.state=this.STATES.CHOOSE_MONSTER_TO_ATTACK);break;case this.STATES.DRAGON_ATTACKS:case this.STATES.CHOOSE_BANNERS_TO_REROLL:case this.STATES.CHOOSE_MONSTER_TO_ATTACK:case this.STATES.GAME_WON:case this.STATES.INTRO:case this.STATES.IDLE:break;default:throw new Error('World One animation state "'.concat(this.state," is not accounted for"))}this.entityManager.tick(t)}},{key:"render",value:function(t){var e=u.GAME_WIDTH/2,r=u.GAME_HEIGHT/2;this.player.render(t),this.enemyParty.render(t),t.drawText("State: ".concat(this.state),e-240,r+32+16+8,u.COLORS.RED,!1,u.BIG_FONT_SIZE),t.drawText("Level: ".concat(this.level),e-112,r+16,u.COLORS.RED,!0,u.MASSIVE_FONT_SIZE),this.entityManager.render(t),this.drawStateText(t)}},{key:"actionTaken",value:function(t){switch(t){case u.ACTIONS.REROLL:if(this.state!==this.STATES.CHOOSE_BANNERS_TO_REROLL)throw new Error("REROLL Action taken when state was not choose_banners_to_reroll. State: ".concat(this.state));if(!this.selectedChamps.length&&!this.selectedEnemies.length)return void alert("Please select banners in Enemy or Player Party to reroll.");var e=this.rerollSelectedEntities(this.selectedChamps);this.player.replaceRerolledPartyMembers(e);var r=this.rerollSelectedEntities(this.selectedEnemies);this.enemyParty.replaceRerolledPartyMembers(r),this.selectedRerollScroll&&(this.selectedRerollScroll.selected=!1),this.clearSelectedEntities(),this.clearActionButtonAction(),this.state=this.STATES.USE_HERO_POWER;break;case u.ACTIONS.ATTACK:if(!this.attackingChamp)throw new Error("actionTaken() No attackingChamp!");if(0===this.selectedEnemies.length)throw new Error("actionTaken() No selectedEnemies!");this.player.sendToGraveyard(this.attackingChamp),this.attackingChamp.selected=!1,this.attackingChamp.attacking=!1,this.attackingChamp=null,this.enemyParty.removeAttackedMonsters(this.selectedEnemies),this.selectedEnemies=[],this.checkForVictoryOrDefeat();break;default:throw new Error("actionTaken() action not recognized ".concat(t))}}},{key:"checkForVictoryOrDefeat",value:function(){if(0===this.enemyParty.length)return alert("You won!"),this.state,void this.STATES.GAME_WON;this.state=this.STATES.CHOOSE_ATTACKING_CHAMP}},{key:"rerollSelectedEntities",value:function(t){var e=this;return t.map((function(t,r){var n;if(t.selected)switch(t.type){case u.TYPES.CHAMP:case u.TYPES.WHITE_ITEM:return n=e.rollChamp(r,t),e.entityManager.addEntity(n),n.id=t.id,n;case u.TYPES.ENEMY:case u.TYPES.BLACK_ITEM:return n=e.rollEnemy(r,t),e.entityManager.addEntity(n),n.id=t.id,n;default:throw console.log(t),new Error("Unexpected entity.type in world.rerollSelectedEntities => ".concat(t.type))}return t}))}},{key:"addSelectedChamp",value:function(t){t.selected=!0,this.selectedChamps.push(t)}},{key:"removeSelectedChamp",value:function(t){t.selected=!1,this.selectedChamps=this.selectedChamps.filter((function(e){return e.id!=t.id}))}},{key:"addSelectedEnemy",value:function(t){t.selected=!0,this.selectedEnemies.push(t)}},{key:"removeSelectedEnemy",value:function(t){t.selected=!1,this.selectedEnemies=this.selectedEnemies.filter((function(e){return e.id!=t.id}))}},{key:"drawStateText",value:function(t){var e="",r="",n="";switch(this.state){case this.STATES.TEST_INIT:break;case this.STATES.INITIALIZE:e="Initializing...";break;case this.STATES.ROLL_ENEMIES:e="Creating Enemy Party";break;case this.STATES.CHOOSE_ATTACKING_CHAMP:e="Click one of your banners to attack the enemy party.",r="Hammer kills all Skeletons. Swords all Goblins. Mage hat all slimes.",n="Champion helm can kill all of one kind. Any banner can kill 1 of any kind.";break;case this.STATES.CHOOSE_MONSTER_TO_ATTACK:e="Now choose a monster in Enemy Party to attack.";break;case this.STATES.GAME_WON:e="Game Won";break;case this.STATES.USE_HERO_POWER:e="Click your Hero to use their power.",r='Or click "Skip Phase" to move on.';break;case this.STATES.USE_SCROLLS:e="Click a scroll to use it to reroll any number of party and enemy members.",r='Or click "Skip Phase" to move on.';break;case this.STATES.CHOOSE_BANNERS_TO_REROLL:e="Choose any number of Enemy Party and Player Party banners to reroll.",r='Then click "Reroll" or click "Skip Phase" to cancel.';break;case this.STATES.DRAGON_ATTACKS:e="Oh no! You have rolled 3 dragons, so the Dragon attacks!",r="You must use 2 different types of companions to defeat the Dragon!";break;default:e="Welcome to Dungeon Roller!"}t.drawText("Phase: ".concat(e),96,u.GAME_HEIGHT-112,u.COLORS.BLACK,!0,u.FONT_SIZE),r&&t.drawText(r,96,u.GAME_HEIGHT-112+32,u.COLORS.BLACK,!0,u.FONT_SIZE),n&&t.drawText(n,96,u.GAME_HEIGHT-112+64,u.COLORS.BLACK,!0,u.FONT_SIZE)}},{key:"clearActionButtonAction",value:function(){var t=this.entityManager.findEntityByType(u.TYPES.ACTION_BUTTON)[0];if(!t)throw new Error("Action Button type not found!");t.clearAction()}},{key:"skipPhaseClicked",value:function(){switch(this.state){case this.STATES.CHOOSE_BANNERS_TO_REROLL:case this.STATES.USE_SCROLLS:this.selectedRerollScroll&&(this.selectedRerollScroll.selected=!1),this.clearSelectedEntities(),this.clearActionButtonAction(),this.state=this.STATES.USE_HERO_POWER;break;case this.STATES.USE_HERO_POWER:this.state=this.STATES.CHOOSE_ATTACKING_CHAMP;break;default:throw new Error("no case for skipPhaseClicked() in state: ".concat(this.state))}}},{key:"init",value:function(){this.level=1;var t=new tr(this.handler,32,192,u.GAME_WIDTH/4,u.GAME_HEIGHT/4);this.enemyParty.setDragonsLair(t),this.entityManager.addEntity(t);var e=u.GAME_WIDTH/4+12,r=new ir(this.handler,u.GAME_WIDTH-e-32,192,e,u.GAME_HEIGHT/4);this.player.setGraveYard(r),this.entityManager.addEntity(r),this.rollPlayerParty(),this.loadEntities()}},{key:"rollChamp",value:function(t){var e,r=Object.keys(u.WHITE_BANNERS).map((function(t){return u.WHITE_BANNERS[t]})),n=rndIndex(r);switch(n){case u.WHITE_BANNERS.CHAMPION:e=new Et(this.handler);break;case u.WHITE_BANNERS.FIGHTER:e=new kt(this.handler);break;case u.WHITE_BANNERS.PALADIN:e=new xt(this.handler);break;case u.WHITE_BANNERS.THIEF:e=new Lt(this.handler);break;case u.WHITE_BANNERS.WIZARD:e=new Kt(this.handler);break;case u.WHITE_BANNERS.SCROLL:e=new Me(this.handler);break;default:throw new Error("Default case hit for WHITE_BANNERS entity switch. Value: ".concat(n))}return e.index=t,e.dontRender=!0,e}},{key:"rollPlayerParty",value:function(){this.player.clearParty();for(var t=0;t<7;t++){var e=this.rollChamp(t);this.player.addToParty(e),this.entityManager.addEntity(e)}}},{key:"getSpatialGrid",value:function(){return this.spatialGrid}}])&&Er(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Pr(t){return Pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pr(t)}function _r(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Pr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Pr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Pr(o)?o:String(o)),n)}var o}var kr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.handler=e,this.channels={music:new Audio,sfx:new Audio},this.sources={bgm:{type:"music",source:this.getMusic("bgm"),loops:!0},station1:{type:"music",source:this.getMusic("station1"),loops:!0},station2:{type:"music",source:this.getMusic("station2"),loops:!0},station3:{type:"music",source:this.getMusic("station3"),loops:!0},phoneRinging:{type:"sfx",source:this.getMusic("phone-ringing"),loops:!1},dialing:{type:"sfx",source:this.getMusic("dialing"),loops:!1},speak1:{type:"sfx",source:this.getMusic("speak-1"),loops:!1},speak2:{type:"sfx",source:this.getMusic("speak-2"),loops:!1},speak3:{type:"sfx",source:this.getMusic("speak-3"),loops:!1},roboSpeak1:{type:"sfx",source:this.getMusic("robo-speak-1"),loops:!1},roboSpeak2:{type:"sfx",source:this.getMusic("robo-speak-2"),loops:!1},roboSpeak3:{type:"sfx",source:this.getMusic("robo-speak-3"),loops:!1}}}var e,r;return e=t,r=[{key:"getMusic",value:function(t){return"".concat(u.MUSIC_PATH,"/").concat(t,".mp3")}},{key:"getChannelByType",value:function(t){return"music"===t?this.channels.music:this.channels.sfx}},{key:"initSound",value:function(t,e){var r=this.getChannelByType(t.type);return r.pause(),r.currentTime=0,r.src=t.source,r.loop=t.loops,r.volume=e,r}},{key:"speak",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.play("roboSpeak"+rndInt(1,3),.35):this.play("speak"+rndInt(1,3),.2)}},{key:"play",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,r=this.sources[t];if(r)try{var n=this.initSound(r,e);return n.play(),n}catch(t){throw new Error(t)}throw new Error('Sound with name "'.concat(t,'" not found.'))}}],r&&_r(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Ar(t){return Ar="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ar(t)}function Rr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ar(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ar(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ar(o)?o:String(o)),n)}var o}var jr=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.game=e,this.entityManager=null,this.graphicsManager=null,this.monsterManager=null,this.mouseManager=null,this.seedManager=null,this.stateManager=null,this.uiManager=null,this.world=null}var e,n;return e=t,(n=[{key:"getEntityManager",value:function(){return this.entityManager}},{key:"getGame",value:function(){return this.game}},{key:"getGraphicsManager",value:function(){return this.graphicsManager}},{key:"getMouseManager",value:function(){return this.mouseManager}},{key:"getSoundManager",value:function(){return this.soundManager}},{key:"getWorld",value:function(){return this.world}},{key:"createEntityManager",value:function(){return this.entityManager=new Z(this)}},{key:"createGraphicsManager",value:function(){return this.graphicsManager=new l}},{key:"createMouseManager",value:function(){return this.mouseManager=new i(this)}},{key:"createSoundManager",value:function(){return this.soundManager=new kr(this)}},{key:"createStateManager",value:function(){return this.stateManager=new q}},{key:"setWorld",value:function(t){return this.world=t}},{key:"updateWorld",value:function(t){this.setWorld(t);var e=new r(this,t);this.stateManager.setState(e)}},{key:"event",value:function(t,e){"click"===t&&this.entityManager.mouseClick(e),"move"===t&&this.entityManager.mouseMove(e)}}])&&Rr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Cr(t){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr(t)}function xr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Cr(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Cr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Cr(o)?o:String(o)),n)}var o}var Ir=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,n;return e=t,(n=[{key:"initialize",value:function(){this.managerHandler=new jr(this),this.graphicsManager=this.managerHandler.createGraphicsManager(),this.stateManager=this.managerHandler.createStateManager(),this.mouseManager=this.managerHandler.createMouseManager(),this.managerHandler.createSoundManager();var t=new Tr(this.managerHandler);this.managerHandler.setWorld(t);var e=new r(this.managerHandler,t);this.stateManager.setState(e)}},{key:"run",value:function(){var t=this;this.initialize();var e=1e3/u.FPS,r=0,n=a/1e3,o=Date.now(),i=o,a=0;!function u(){o=Date.now(),r=o-i,i=o,(a+=r)>=e&&(n=a/1e3,t.tick(n),t.render(t.graphicsManager.getGraphics()),a=0),window.requestAnimationFrame(u)}()}},{key:"tick",value:function(t){this.stateManager.getState().tick(t)}},{key:"render",value:function(t){t.clearRect(0,0,u.GAME_WIDTH,u.GAME_HEIGHT),this.stateManager.getState().render(t)}}])&&xr(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();document.title="Dungeon Roller",window.rndIndex=function(t){return t[Math.floor(Math.random()*t.length)]},window.rndInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},(new Ir).run()})();